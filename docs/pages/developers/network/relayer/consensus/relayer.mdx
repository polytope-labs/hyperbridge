---
title: Consensus Relayers
description: Running the Hyperbridge Consensus relayer
---

# Running a Consensus Relayer

The Hyperbridge consensus relayer (tesseract) can be obtained through a variety of ways. For now only release artifacts for x86 linux environments are officially distributed.
Please note that building the Tesseract relayer from source is not supported at this time. The codebase includes private dependencies that are not publicly available, making it impossible to compile independently.

## Prebuilt binaries

You can install a prebuilt binary for the Tesseract consensus relayer with the following bash script

```bash
LATEST_TAG=$(curl -s https://hub.docker.com/v2/repositories/polytopelabs/tesseract-consensus/tags\?page_size\=1\&page\=2 | jq -r '.results[0].name')
wget -q --show-progress https://github.com/polytope-labs/hyperbridge/releases/download/tesseract-consensus-$LATEST_TAG/tesseract-x86_64-unknown-linux-gnu.tar.gz
tar -xvzf tesseract-x86_64-unknown-linux-gnu.tar.gz
# copy to $PATH
cp tesseract-x86_64-unknown-linux-gnu/tesseract $HOME/.local/bin/
```

or a 1-liner

```bash
LATEST_TAG=$(curl -s https://hub.docker.com/v2/repositories/polytopelabs/tesseract-consensus/tags\?page_size\=1\&page\=2 | jq -r '.results[0].name')
curl --proto '=https' --tlsv1.2 -LsSf https://github.com/polytope-labs/hyperbridge/releases/download/tesseract-consensus-$LATEST_TAG/tesseract-installer.sh | sh
```

## Docker

Tesseract Consensus is available at the official docker repository [`polytopelabs/tesseract-consensus`](https://hub.docker.com/r/polytopelabs/tesseract-consensus)

```bash
docker pull polytopelabs/tesseract-consensus:latest
```

## Running the relayer

The tesseract consensus relayer command line interface expects two arguments, which are the paths to its configuration file and optional base state machine to use for consensus initialization.
If you're running it in a docker container, you will need to [map the directory](https://docs.docker.com/storage/bind-mounts/#start-a-container-with-a-bind-mount) where you've stored the configuration file on your host into the docker container.
```bash
docker run -d \
  --name=tesseract-consensus \
  --network=host \
  --restart=always \
  --volume=/dir/on/host:/home/root \
  polytopelabs/tesseract-consensus:latest \
  --config=/home/root/consensus-config.toml \
```


Access its logs using

```bash
docker logs -f tesseract-consensus
```

### System Requirements

At the minimum, the hyperbridge consensus relayer should be run on a machine with at least 4GB of RAM and a quad-core cpu. This relayer should also have at least a 100Mb/s connection if it is to query nodes over the internet.

## Configuration

The tesseract relayer is configured using a single consensus-config.toml file. The structure is designed to be modular: you start with a base configuration that is always required,
and then append the configuration blocks for each network you wish to relay.

### Base configuration (Required)

```toml
# Hyperbridge consensus client config, required.
# This section defines how the relayer connects to and interprets the Hyperbridge chain.
[hyperbridge]
# Specifies the consensus mechanism of the Hyperbridge chain.
# "grandpa" is used for Substrate-based chains utilizing the GRANDPA finality gadget.
# "beefy" is used for chains utilizing the BEEFY finality gadget
type = "grandpa"

# Configuration specific to the GRANDPA consensus client.
[hyperbridge.grandpa]
# The WebSocket RPC endpoint for a Standalone or Relay Chain.
rpc = "wss://polkadot-rpc.n.dwellir.com"

# The expected time duration for a block slot in milliseconds.
slot_duration = 6000

# (Optional) How often to query for consensus updates. This is in seconds
consensus_update_frequency = 60

# A list of parachain IDs that are connected to this relay chain and should be monitored.
para_ids = [3367]

# Configuration for the Hyperbridge parachain itself.
[hyperbridge.substrate]
# The WebSocket RPC endpoint for the Hyperbridge parachain.
rpc_ws = "wss://nexus.ibp.network"

# (Optional) The hashing algorithm used by the parachain. Can be "Keccak" or "Blake2".
hashing = "Keccak"

# (Optional) The consensus state identifier for Hyperbridge itself.
# For Hyperbridge Mainnet, this is "DOT0".
consensus_state_id = "DOT0"

# The state machine identifier for the Hyperbridge parachain.
# state_machine = "KUSAMA-4009" # Hyperbridge parachain testnet Testnet
state_machine = "POLKADOT-3367"

# (Optional) Maximum size in bytes for the rpc payloads, both requests & responses.
# max_rpc_payload_size = 2

# Relayer account seed. This can be generated using subkey
signer = "YOUR-PRIVATE-KEY"

# (Optional) Initial height from which to start querying messages.
# initial_height = 0

# (Optional) Maximum concurrent rpc requests allowed.
max_concurent_queries = 0

# Relayer-specific configuration.
[relayer]
# A list of maximum update intervals for specific chains.
# This is The maximum interval in seconds allowed between consensus updates for each state machine
# before the process should be restarted.
maximum_update_intervals = [
    [{ state_id = "EVM-1", consensus_state_id = "ETH0"}, 900],
    [{ state_id = "EVM-100", consensus_state_id = "GNO0"}, 420],
    [{ state_id = "EVM-56", consensus_state_id = "BSC0"}, 300],
]

# Controls whether the relayer should start Hyperbridge consensus task
enable_hyperbridge_consensus = false
```

### Add Network Configurations
Now, you can choose between any of the networks Hyperbridge supports for your relayer to connect to.

#### Ethereum

```toml
# Configuration for Sepolia (L1).
[ethereum]
# The type of chain configuration. "evm" is for standard EVM-compatible chains.
type = "ethereum"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-1"

# A list of HTTP(s) RPC URLs for this chain.
rpc_urls = ["http://localhost:3000"]

# The consensus state identifier for this chain on Hyperbridge.
consensus_state_id = "ETH0"

# Etherscan API key for this chain.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this chain.
ismp_host = "0x792A6236AF69787C40cF76b69B4c8c7B28c4cA20"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"

# Host configuration for this chain (as it hosts L2s).
[ethereum.host]
# A list of HTTP URLs for the consensus layer beacon node.
beacon_http_urls = [
    "http://localhost:3000"
]

# How frequently consensus updates are fetched from the beacon node, in seconds.
consensus_update_frequency = 60
```

#### Arbitrum

```toml
# Configuration for an Arbitrum Orbit chain (L2).
[arbitrum]
# The type of chain configuration. "arbitrum_orbit" is for Arbitrum L2s.
type = "arbitrum_orbit"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-42161"

# A list of HTTP(s) RPC URLs for this chain. Multiple endpoints can be provided for reliability.
rpc_urls = ["http://localhost:3100"]

# The consensus state identifier for this chain's host (L1) on Hyperbridge.
# For Ethereum and its L2s, this is typically "ETH0".
consensus_state_id = "ARB0"

# Etherscan API key for fetching gas prices and other on-chain data.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this Arbitrum chain.
ismp_host = "0xE05AFD4Eb2ce6d65c40e1048381BD0Ef8b4B299e"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"


# Host (L1) configuration for the Arbitrum Orbit chain above.
[arbitrum.host]
# The RPC URL for the Ethereum node.
ethereum_rpc_url = ["http://localhost:3400"]

# [The address of the RollupCore contract on the L1.](https://docs.arbitrum.io/build-decentralized-apps/reference/contract-addresses)
rollup_core = "ROLLUP-CONTRACT-ADDRESS"

# State machine Identifier for the L1/Beacon chain.
l1_state_machine = "EVM-1"

# L1 Consensus state Id representation.
l1_consensus_state_id = "ETH0"
```

#### Optimism
```toml
# Configuration for an OP Stack chain (L2).
[optimism]
# The type of chain configuration. "op_stack" is for Optimism L2s and other OP Stack chains.
type = "op_stack"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-10"

# A list of HTTP(s) RPC URLs for this chain.
rpc_urls = ["http://localhost:3400"]

# Etherscan API key for this chain.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this Optimism chain.
ismp_host = "0x78c8A5F27C06757EA0e30bEa682f1FD5C8d7645d"

# The consensus state identifier for this chain's host (L1) on Hyperbridge.
consensus_state_id = "OPT0"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"

# Host (L1) configuration for the OP Stack chain above.
[optimism.host]
# [The address of the DisputeGameFactory contract on the L1.](https://docs.optimism.io/superchain/addresses)
dispute_game_factory = "DISPUTE-GAME-FACTORY-ADDRESS"

# State machine Identifier for the L1/Beacon chain.
l1_state_machine = "EVM-1"

# L1 Consensus state Id representation.
l1_consensus_state_id = "ETH0"
```

#### BSC
```toml
# Configuration for BSC.
[bsc]
# The type of chain configuration. "bsc" is for the Binance Smart Chain.
type = "bsc"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-56"

# A list of HTTP(s) RPC URLs for this chain. Multiple endpoints can be provided for reliability.
rpc_urls = ["http://localhost:3400"]

# The consensus state identifier for this chain's host (L1) on Hyperbridge.
consensus_state_id = "BSC0"

# Etherscan API key for fetching gas prices and other on-chain data.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this bsc chain.
ismp_host = "0x24B5d421Ec373FcA57325dd2F0C074009Af021F7"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"

# Host (L1) configuration for BSC
[bsc.host]
# How often to query for consensus updates. This is in seconds
consensus_update_frequency = 60

# This represent the length of an epoch for BSC
epoch_length = 1000
```

#### Gnosis
```toml
# Configuration for Gnosis.
[gnosis]
# The type of chain configuration. "evm" is for standard EVM-compatible chains.
type = "gnosis"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-100"

# A list of HTTP(s) RPC URLs for this chain.
rpc_urls = ["http://localhost:3000"]

# The consensus state identifier for this chain on Hyperbridge.
consensus_state_id = "GNO0"

# Etherscan API key for this chain.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this chain.
ismp_host = "0x50c236247447B9d4Ee0561054ee596fbDa7791b1"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"

# Host configuration for this chain (as it hosts L2s).
[gnosis.host]
# A list of HTTP URLs for the consensus layer beacon node.
beacon_http_urls = [
    "http://localhost:3000"
]

# How frequently consensus updates are fetched from the beacon node, in seconds.
consensus_update_frequency = 60
```

#### Unichain
```toml
# Configuration for an OP Stack chain (L2).
[unichain]
# The type of chain configuration. "op_stack" is for Optimism L2s and other OP Stack chains.
type = "op_stack"

# The state machine identifier for this chain, formatted as "EVM-{chainId}".
state_machine = "EVM-130"

# A list of HTTP(s) RPC URLs for this chain.
rpc_urls = ["http://localhost:3400"]

# Etherscan API key for this chain.
etherscan_api_key = "API-KEY"

# The deployed IsmpHost contract address on this Optimism chain.
ismp_host = "0x2A17C1c3616Bbc33FCe5aF5B965F166ba76cEDAf"

# The consensus state identifier for this chain's host (L1) on Hyperbridge.
consensus_state_id = "UNI0"

# Hex-encoded private key for the relayer account on this chain.
signer = "SIGNER-KEY"

# Host (L1) configuration for the OP Stack chain above.
[unichain.host]
# [The address of the DisputeGameFactory contract on the L1.](https://docs.unichain.org/docs/technical-information/contract-addresses)
dispute_game_factory = "DISPUTE-GAME-FACTORY-ADDRESS"

# State machine Identifier for the L1/Beacon chain.
l1_state_machine = "EVM-1"

# L1 Consensus state Id representation.
l1_consensus_state_id = "ETH0"
```
Before running the relayer, please review your configuration file and ensure you have replaced all placeholder values.

#### Important Check list

- `YOUR-PRIVATE-KEY`: Your Hyperbridge account's(controller) private key, this you can use subkey to generate.
- `SIGNER-KEY`: Your EVM account's hex-encoded private key.
- `API-KEY`: Your Etherscan API key.
- contract addresses (e.g., rollup_core) are correct for the network.
- All rpc_urls and ethereum_rpc_url endpoints are correct and accessible.

You can obtain the required etherscan API key by following [this guide](https://docs.etherscan.io/getting-started/viewing-api-usage-statistics) for the appropriate network. Do note that since Ethereum and its L2s all use Ether as the gas token. They can all share the same etherscan API key.

### Contract addresses

You can find the addresses for the `IsmpHost` contracts for [mainnet](/developers/explore/configurations/mainnet) and [testnet](/developers/explore/configurations/testnet)
